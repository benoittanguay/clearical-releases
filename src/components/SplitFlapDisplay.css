/* Split-Flap Display Component Styles */
/* Realistic mechanical flip clock with proper 3D animations */

/* ============================================================================
   Base Display Container
   ============================================================================ */

.split-flap-display {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-family: 'JetBrains Mono', 'Courier New', monospace;
  font-weight: 600;
  user-select: none;
}

.split-flap-container {
  display: flex;
  align-items: center;
  gap: 2px;
  /* Add perspective here so all digits share same viewing angle */
  perspective: 1200px;
  transform-style: preserve-3d;
}

/* ============================================================================
   Individual Digit Container
   ============================================================================ */

.split-flap-digit {
  position: relative;
  display: inline-block;
  background: #1a1a1a;
  border-radius: 4px;
  box-shadow:
    0 2px 4px rgba(0, 0, 0, 0.3),
    inset 0 1px 2px rgba(255, 255, 255, 0.1),
    inset 0 -1px 2px rgba(0, 0, 0, 0.5);
  /* REMOVED overflow: hidden - it was clipping the rotating flaps! */
  /* MOVED perspective to parent for better 3D viewing angle */
  transform-style: preserve-3d;
}

/* ============================================================================
   Size Variants
   ============================================================================ */

.split-flap-display--small .split-flap-digit {
  width: 24px;
  height: 36px;
  font-size: 20px;
  line-height: 18px;
  border-radius: 3px;
}

.split-flap-display--small .split-flap-container {
  perspective: 800px;
}

.split-flap-display--medium .split-flap-digit {
  width: 36px;
  height: 54px;
  font-size: 32px;
  line-height: 27px;
  border-radius: 4px;
}

.split-flap-display--medium .split-flap-container {
  perspective: 1200px;
}

.split-flap-display--large .split-flap-digit {
  width: 48px;
  height: 72px;
  font-size: 42px;
  line-height: 36px;
  border-radius: 6px;
}

.split-flap-display--large .split-flap-container {
  perspective: 1600px;
}

/* ============================================================================
   Flap Halves - Base Styles
   ============================================================================ */

.flap-half {
  position: absolute;
  width: 100%;
  height: 50%;
  overflow: hidden;
  background: #1a1a1a;
  /* CHANGED: visible instead of hidden so we can see the flip! */
  backface-visibility: visible;
  transform-style: preserve-3d;

  /* Add visible thickness/depth to the flaps so rotation is obvious */
  /* This creates a 3D "card" effect with visible edges */
  box-shadow:
    /* Side shadow that becomes visible during rotation */
    2px 0 4px rgba(0, 0, 0, 0.4),
    -2px 0 4px rgba(0, 0, 0, 0.4),
    /* Bottom edge shadow for depth */
    0 2px 6px rgba(0, 0, 0, 0.5);
}

/* ============================================================================
   Static Flaps (visible when not animating)
   ============================================================================ */

.flap-top-static {
  top: 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.5);
  border-radius: 4px 4px 0 0;
  z-index: 1;
  /* Clip to container bounds to prevent text overflow */
  clip-path: inset(0);
}

.flap-bottom-static {
  bottom: 0;
  border-top: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 0 0 4px 4px;
  z-index: 1;
  /* Clip to container bounds to prevent text overflow */
  clip-path: inset(0);
}

/* Old digit overlay - sits above static bottom, below animated bottom */
/* Shows old digit during flip, gets covered by animated bottom flap */
.flap-old-overlay {
  z-index: 2;
}

/* ============================================================================
   Animation Visibility States
   Using visibility/opacity instead of conditional render to avoid flicker
   ============================================================================ */

.flap-active {
  visibility: visible;
  opacity: 1;
}

.flap-hidden {
  visibility: hidden;
  opacity: 0;
  animation: none !important;
  pointer-events: none;
  /* Quick fade to avoid flicker */
  transition: opacity 50ms ease-out, visibility 0ms linear 50ms;
}

/* Persistent bottom flap - stays visible after animation ends */
/* Prevents flicker by never hiding - just stays at final position */
.flap-bottom-persistent {
  /* Override any hidden state - this flap is always visible */
  visibility: visible !important;
  opacity: 1 !important;
  /* Ensure it's always on top of other bottom elements */
  z-index: 45 !important;
}

/* ============================================================================
   Animated Flaps (visible only during flip)
   ============================================================================ */

/* Top flap flips DOWN from 0° to -90° (hinged at bottom edge) */
.flap-top-animated {
  top: 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.5);
  border-radius: 4px 4px 0 0;
  z-index: 50; /* INCREASED: Must be above split line (z-index: 30) */

  /* Same background as static flaps - no orange tint */
  background: #1a1a1a;

  /* Transform origin at bottom center - this is where the hinge is */
  transform-origin: center bottom;

  /* SLOWED DOWN: 600ms instead of 450ms for visibility */
  /* Gravity-style easing: starts slow, accelerates down */
  /* Dramatic flip with enhanced shadow during motion */
  animation: flipTopDown 600ms cubic-bezier(0.55, 0.0, 0.1, 1.0) forwards;
  will-change: transform, box-shadow;
}

/* Bottom flap flips UP from 90° to 0° (hinged at top edge) */
.flap-bottom-animated {
  bottom: 0;
  border-top: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 0 0 4px 4px;
  z-index: 40; /* INCREASED: Must be above static flaps and visible during animation */

  /* SOLID opaque background - must cover the static bottom beneath it */
  background: #1a1a1a;

  /* Ensure this flap is fully opaque and covers what's beneath */
  opacity: 1;

  /* Transform origin at top center - this is where the hinge is */
  transform-origin: center top;

  /* Starts at 90° (hidden behind top flap) */
  /* SLOWED DOWN: 500ms instead of 380ms, with 300ms delay instead of 220ms */
  /* Delayed start for realism - begins after top flap passes ~45° */
  /* Bounce easing for mechanical feel */
  /* Dramatic animation with enhanced shadow during motion */
  animation: flipBottomUp 500ms cubic-bezier(0.34, 1.56, 0.64, 1.0) 300ms forwards;
  will-change: transform, box-shadow;

  /* Initial state - rotated 90° (perpendicular to screen) */
  transform: rotateX(90deg);
}

/* ============================================================================
   Keyframe Animations
   ============================================================================ */

/**
 * Top flap animation: Flips down from 0° to -90°
 * Uses gravity-like easing (ease-in) - accelerates as it falls
 * Enhanced with dramatic shadows and brightness changes for visibility
 * NOW WITH translateZ for actual 3D depth during rotation!
 * NEUTRAL SHADOWS - no orange coloring
 */
@keyframes flipTopDown {
  0% {
    transform: rotateX(0deg) translateZ(1px);
    opacity: 1;
    filter: brightness(1.3); /* BRIGHTER START for visibility */
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.7), 0 4px 12px rgba(0, 0, 0, 0.6);
  }

  /* ENHANCED brightness and shadow at mid-flip for dramatic effect */
  30% {
    transform: rotateX(-27deg) translateZ(8px);
    opacity: 1;
    filter: brightness(1.5); /* VERY BRIGHT */
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.85), 0 8px 20px rgba(0, 0, 0, 0.8);
  }

  50% {
    transform: rotateX(-45deg) translateZ(12px);
    opacity: 1;
    filter: brightness(1.4);
    box-shadow: 0 12px 36px rgba(0, 0, 0, 0.9), 0 10px 24px rgba(0, 0, 0, 0.85);
  }

  /* Still bright as it approaches perpendicular - MAX Z-depth here! */
  75% {
    transform: rotateX(-67.5deg) translateZ(10px);
    opacity: 0.95;
    filter: brightness(1.1); /* KEPT BRIGHTER */
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.75), 0 6px 16px rgba(0, 0, 0, 0.7);
  }

  /* Final state - fully flipped */
  100% {
    transform: rotateX(-90deg) translateZ(0px);
    opacity: 0;
    filter: brightness(0.8);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), 0 2px 8px rgba(0, 0, 0, 0.5);
  }
}

/**
 * Bottom flap animation: Flips up from 90° to 0°
 * Uses bounce easing for mechanical realism
 * Enhanced with dramatic shadows and brightness for visibility
 * NOW WITH translateZ for actual 3D depth during rotation!
 * NEUTRAL SHADOWS - no orange coloring
 * IMPORTANT: opacity stays at 1.0 throughout - this flap must cover the static bottom
 */
@keyframes flipBottomUp {
  0% {
    transform: rotateX(90deg) translateZ(0px);
    opacity: 1; /* FULLY OPAQUE - must cover what's beneath */
    filter: brightness(0.9);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), 0 2px 8px rgba(0, 0, 0, 0.5);
  }

  /* DRAMATIC fade in as it emerges from behind top flap */
  15% {
    transform: rotateX(67.5deg) translateZ(10px);
    opacity: 1; /* FULLY OPAQUE - must cover what's beneath */
    filter: brightness(1.2);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.75), 0 6px 16px rgba(0, 0, 0, 0.7);
  }

  /* Mid-point with enhanced shadow - MAX Z-depth! */
  40% {
    transform: rotateX(45deg) translateZ(12px);
    opacity: 1; /* FULLY OPAQUE - must cover what's beneath */
    filter: brightness(1.4); /* VERY BRIGHT */
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.85), 0 8px 20px rgba(0, 0, 0, 0.8);
  }

  /* PEAK brightness as it approaches final position */
  70% {
    transform: rotateX(22.5deg) translateZ(8px);
    opacity: 1; /* FULLY OPAQUE - must cover what's beneath */
    filter: brightness(1.5); /* MAXIMUM BRIGHTNESS */
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.8), 0 6px 16px rgba(0, 0, 0, 0.7);
  }

  /* Final position - still bright, slight overshoot handled by cubic-bezier */
  100% {
    transform: rotateX(0deg) translateZ(1px);
    opacity: 1; /* FULLY OPAQUE - must cover what's beneath */
    filter: brightness(1.2); /* BRIGHTER END STATE */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6), 0 2px 8px rgba(0, 0, 0, 0.5);
  }
}

/* ============================================================================
   Size-Specific Border Radius
   ============================================================================ */

.split-flap-display--small .flap-top-static,
.split-flap-display--small .flap-top-animated {
  border-radius: 3px 3px 0 0;
}

.split-flap-display--small .flap-bottom-static,
.split-flap-display--small .flap-bottom-animated {
  border-radius: 0 0 3px 3px;
}

.split-flap-display--large .flap-top-static,
.split-flap-display--large .flap-top-animated {
  border-radius: 6px 6px 0 0;
}

.split-flap-display--large .flap-bottom-static,
.split-flap-display--large .flap-bottom-animated {
  border-radius: 0 0 6px 6px;
}

/* ============================================================================
   Digit Content Positioning
   ============================================================================ */

.flap-content {
  position: absolute;
  width: 100%;
  /* Height is 200% to span the full digit container (both halves) */
  height: 200%;
  /* Center the text vertically within the full 200% height */
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  color: #f5f5f5;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
}

/* Top half shows TOP portion of digit (upper 50% visible) */
.flap-content-top {
  /* Position at top of container - shows upper half of the digit */
  top: 0;
}

/* Bottom half shows BOTTOM portion of digit (lower 50% visible) */
.flap-content-bottom {
  /* Position so bottom half of digit is visible in bottom flap */
  /* Translate up by 50% to show the lower portion of the 200% tall content */
  top: -100%;
}

/* ============================================================================
   Center Split Line
   ============================================================================ */

.flap-split-line {
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(
    to bottom,
    rgba(0, 0, 0, 0.6) 0%,
    rgba(0, 0, 0, 0.8) 50%,
    rgba(0, 0, 0, 0.6) 100%
  );
  transform: translateY(-1px);
  z-index: 30;
  pointer-events: none;
}

/* ============================================================================
   Colon Separator
   ============================================================================ */

.split-flap-separator {
  display: flex;
  align-items: center;
  justify-content: center;
  color: #f5f5f5;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
  margin: 0 0px;
}

.split-flap-display--small .split-flap-separator {
  font-size: 20px;
  margin: 0 0px;
}

.split-flap-display--medium .split-flap-separator {
  font-size: 32px;
  margin: 0 0px;
}

.split-flap-display--large .split-flap-separator {
  font-size: 42px;
  margin: 0 1px;
}

/* ============================================================================
   Lighting Effects for Realism
   ============================================================================ */

/* Subtle shine on top half */
.flap-top-static::before,
.flap-top-animated::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 50%;
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.08) 0%,
    rgba(255, 255, 255, 0) 100%
  );
  pointer-events: none;
  z-index: 5;
}

/* Subtle shadow on bottom half for depth */
.flap-bottom-static::after,
.flap-bottom-animated::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 50%;
  background: linear-gradient(
    to top,
    rgba(0, 0, 0, 0.3) 0%,
    rgba(0, 0, 0, 0) 100%
  );
  pointer-events: none;
  z-index: 5;
}

/* ============================================================================
   Flip Clock Container - Retro Housing Design
   ============================================================================ */

.flip-clock-container {
  display: inline-block;
}

/* Glass-like bezel with orange accent - now the outermost element */
.flip-clock-bezel {
  position: relative;
  padding: 6px;
  background: linear-gradient(
    135deg,
    var(--color-accent) 0%,
    var(--color-accent-light) 50%,
    var(--color-accent) 100%
  );
  border-radius: 12px;
  box-shadow:
    /* Outer depth shadow */
    0 8px 24px rgba(0, 0, 0, 0.5),
    0 4px 8px rgba(0, 0, 0, 0.3),
    /* Glow effect around border */
    0 0 16px rgba(255, 72, 0, 0.4),
    /* Inner shadow for beveled look */
    inset 0 1px 2px rgba(255, 255, 255, 0.3),
    inset 0 -1px 2px rgba(0, 0, 0, 0.5);
}

/* Inner container with dark background */
.flip-clock-inner {
  background: linear-gradient(180deg, #0a0a0a 0%, #141414 100%);
  padding: 24px 32px;
  border-radius: 8px;
  box-shadow:
    /* Deep inset shadow */
    inset 0 3px 8px rgba(0, 0, 0, 0.8),
    inset 0 1px 2px rgba(0, 0, 0, 0.9),
    /* Subtle rim light */
    inset 0 -1px 1px rgba(255, 255, 255, 0.03);
  position: relative;
}

/* Subtle glass reflection effect on bezel */
.flip-clock-bezel::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 50%;
  background: linear-gradient(
    to bottom,
    rgba(255, 255, 255, 0.15) 0%,
    rgba(255, 255, 255, 0) 100%
  );
  border-radius: 8px 8px 0 0;
  pointer-events: none;
}

/* ============================================================================
   Accessibility - Reduced Motion
   ============================================================================ */

@media (prefers-reduced-motion: reduce) {
  .flap-top-animated,
  .flap-bottom-animated {
    animation: none;
    transition: opacity 150ms ease-out;
  }

  .flap-top-animated {
    opacity: 0;
    transform: rotateX(-90deg);
  }

  .flap-bottom-animated {
    opacity: 1;
    transform: rotateX(0deg);
  }
}
